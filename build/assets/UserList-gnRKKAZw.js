import{r as o,J as h,j as e,u as w}from"./index-xBb4Cu5p.js";import{A as T}from"./AdaptableCard-C8NAqNcm.js";import{A as D}from"./index-DUchRYx7.js";import{B as E}from"./index-CCxRe_lL.js";import{D as I}from"./DataTable-DPSpAcGJ.js";import{w as P,x as R}from"./index-CeosE6Mu.js";import{a as B}from"./index-DllHrx1z.js";import{u as F}from"./useThemeClass-CVZ0ENSo.js";import{u as K}from"./useQuery-C5ra9VKq.js";import{d as _}from"./debounce-BpHb7X8g.js";import{I as L}from"./hoist-non-react-statics.cjs-D9D9Op99.js";import{b as $}from"./UserService-SWdErKII.js";import{B as k}from"./Button-DpFfS7qi.js";import"./Card-DUFOzyf7.js";import"./toString-CfufOl4R.js";import"./Views--okuRfCK.js";import"./index-B9jXH76y.js";import"./_getPrototype-RCTy2yb6.js";const f={super_admin:{label:"Super Admin",dotClass:"bg-[#4f39f6]",textClass:"text-[#4f39f6]"},admin:{label:"Admin",dotClass:"bg-blue-500",textClass:"text-blue-500"},user:{label:"User",dotClass:"bg-gray-500",textClass:"text-gray-500"}},q=()=>{var p,g,x;const m=o.useRef(null),t=h(),[i,j]=o.useState(""),[n,d]=o.useState({page:1,limit:10}),[c,b]=o.useState(null);o.useEffect(()=>{const s=localStorage.getItem("user");if(s)try{b(JSON.parse(s))}catch(r){console.error("Error parsing user data:",r)}},[]);const{data:a,isLoading:C,error:u}=K({queryKey:["users",n,i],queryFn:()=>$({page:n.page,limit:n.limit,search:i})});o.useEffect(()=>{var s,r;console.log("Full API response:",a),console.log("Users data:",(s=a==null?void 0:a.data)==null?void 0:s.data),console.log("Pagination info:",(r=a==null?void 0:a.data)==null?void 0:r.pagination)},[a]);const N=o.useMemo(()=>_(s=>{j(s),d(r=>({...r,page:1}))},500),[]),A=o.useMemo(()=>[{header:"Username",accessorKey:"username",cell:s=>e.jsxs("div",{className:"flex items-center",children:[e.jsx(D,{icon:e.jsx(B,{}),alt:s.row.original.username}),e.jsx("span",{className:"ml-2 font-semibold",children:s.row.original.username})]})},{header:"Role",accessorKey:"role",cell:s=>{const r=s.row.original.role,l=f[r]||f.user;return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(E,{className:l.dotClass}),e.jsx("span",{className:`font-semibold ${l.textClass}`,children:l.label})]})}},{header:"Created At",accessorKey:"createdAt",cell:s=>e.jsx("span",{children:new Date(s.row.original.createdAt).toLocaleDateString()})},{header:"Actions",id:"action",cell:s=>{const{textTheme:r}=F(),l=s.row.original,v=l.role==="super_admin",U=(c==null?void 0:c.role)==="super_admin";return e.jsx("div",{className:"flex justify-center text-lg",children:(!v||U)&&e.jsx("span",{className:`cursor-pointer p-2 hover:${r}`,onClick:()=>t(`/users/edit/${l.id}`),children:e.jsx(P,{})})})}}],[t,c]);if(u)return e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsxs("span",{className:"text-red-500",children:["Error: ",u.message]})});const S=((p=a==null?void 0:a.data)==null?void 0:p.data)||[],y=((x=(g=a==null?void 0:a.data)==null?void 0:g.pagination)==null?void 0:x.total)||0;return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mb-4",children:e.jsx(L,{placeholder:"Search users...",onChange:s=>N(s.target.value),className:"max-w-md"})}),e.jsx(I,{ref:m,columns:A,data:S,loading:C,pagingData:{total:y,pageIndex:n.page,pageSize:n.limit},onPaginationChange:s=>d(r=>({...r,page:s})),onSelectChange:s=>d({page:1,limit:s})})]})},z=()=>{const m=h(),{user:t}=w(i=>i.auth);return(t==null?void 0:t.role)==="super_admin"||(t==null||t.role),e.jsx(k,{size:"sm",variant:"solid",icon:e.jsx(R,{}),onClick:()=>m("/users/create"),children:"Add User"})},ne=()=>e.jsxs(T,{className:"h-full",bodyClass:"h-full",children:[e.jsxs("div",{className:"lg:flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"mb-4 lg:mb-0",children:"Users"}),e.jsx(z,{})]}),e.jsx(q,{})]});export{ne as default};
