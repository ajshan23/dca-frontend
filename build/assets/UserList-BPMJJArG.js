import{r as o,J as h,j as e,u as S}from"./index-BnCfoMHD.js";import{A}from"./AdaptableCard-DRDRsK4S.js";import{A as w}from"./index-egu2WkrI.js";import{B as U}from"./index-DhA5XCq6.js";import{D as T}from"./DataTable-DVOpipVd.js";import{w as E,x as D,y as I}from"./index-CYFR1aV4.js";import{a as R}from"./index-Jl1U2XE-.js";import{u as $}from"./useThemeClass-BLMMXnwv.js";import{u as B}from"./useQuery-5MtxfOZF.js";import{d as K}from"./debounce-D281xMjJ.js";import{I as P}from"./hoist-non-react-statics.cjs-kw-40s0n.js";import{b as _}from"./UserService-f4YMCGJG.js";import{B as k}from"./Button-D0dNB7EA.js";import"./Card-BqTJnQ0J.js";import"./toString-BDdrKkq0.js";import"./proxy-Bkf0PZo_.js";import"./Views-CznXWnk6.js";import"./index-D-LI7_5Q.js";import"./_getPrototype-BbFq-AiP.js";const g={super_admin:{label:"Super Admin",dotClass:"bg-purple-500",textClass:"text-purple-500"},admin:{label:"Admin",dotClass:"bg-blue-500",textClass:"text-blue-500"},user:{label:"User",dotClass:"bg-gray-500",textClass:"text-gray-500"}},F=()=>{var p,x;const m=o.useRef(null),a=h(),[n,f]=o.useState(""),[i,d]=o.useState({page:1,limit:10}),[c,j]=o.useState(null);o.useEffect(()=>{const s=localStorage.getItem("user");if(s)try{j(JSON.parse(s))}catch(r){console.error("Error parsing user data:",r)}},[]);const{data:l,isLoading:b,error:u}=B({queryKey:["users",i,n],queryFn:()=>_({page:i.page,limit:i.limit,search:n})}),C=o.useMemo(()=>K(s=>{f(s),d(r=>({...r,page:1}))},500),[]),N=o.useMemo(()=>[{header:"Username",accessorKey:"username",cell:s=>e.jsxs("div",{className:"flex items-center",children:[e.jsx(w,{icon:e.jsx(R,{}),alt:s.row.original.username}),e.jsx("span",{className:"ml-2 font-semibold",children:s.row.original.username})]})},{header:"Role",accessorKey:"role",cell:s=>{const r=s.row.original.role,t=g[r]||g.user;return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(U,{className:t.dotClass}),e.jsx("span",{className:`font-semibold ${t.textClass}`,children:t.label})]})}},{header:"Created At",accessorKey:"createdAt",cell:s=>e.jsx("span",{children:new Date(s.row.original.createdAt).toLocaleDateString()})},{header:"Actions",id:"action",cell:s=>{const{textTheme:r}=$(),t=s.row.original,y=t.role==="super_admin",v=(c==null?void 0:c.role)==="super_admin";return e.jsxs("div",{className:"flex justify-end text-lg",children:[e.jsx("span",{className:`cursor-pointer p-2 hover:${r}`,onClick:()=>a(`/users/view/${t.id}`),children:e.jsx(E,{})}),(!y||v)&&e.jsx("span",{className:`cursor-pointer p-2 hover:${r}`,onClick:()=>a(`/users/edit/${t.id}`),children:e.jsx(D,{})})]})}}],[a,c]);return u?e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsxs("span",{className:"text-red-500",children:["Error: ",u.message]})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mb-4",children:e.jsx(P,{placeholder:"Search users...",onChange:s=>C(s.target.value),className:"max-w-md"})}),e.jsx(T,{ref:m,columns:N,data:((p=l==null?void 0:l.data)==null?void 0:p.data)||[],loading:b,pagingData:{total:((x=l==null?void 0:l.data)==null?void 0:x.total)||0,pageIndex:i.page,pageSize:i.limit},onPaginationChange:s=>d(r=>({...r,page:s})),onSelectChange:s=>d({page:1,limit:s})})]})},H=()=>{const m=h(),{user:a}=S(n=>n.auth);return(a==null?void 0:a.role)==="super_admin"||(a==null||a.role),e.jsx(k,{size:"sm",variant:"solid",icon:e.jsx(I,{}),onClick:()=>m("/users/create"),children:"Add User"})},le=()=>e.jsxs(A,{className:"h-full",bodyClass:"h-full",children:[e.jsxs("div",{className:"lg:flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"mb-4 lg:mb-0",children:"Users"}),e.jsx(H,{})]}),e.jsx(F,{})]});export{le as default};
