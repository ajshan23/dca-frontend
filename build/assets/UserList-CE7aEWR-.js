import{r as o,J as f,j as e,u as U}from"./index-BzHZzxX0.js";import{A as E}from"./AdaptableCard-BjkToBNq.js";import{A as T}from"./index-ClV6Y1xO.js";import{B as D}from"./index-B6q6Ul9Z.js";import{D as I}from"./DataTable-B6Y_J6Jy.js";import{w as P,x as R,y as $}from"./index-DtRuNtK-.js";import{a as B}from"./index-Crm3lb8V.js";import{u as F}from"./useThemeClass-CizYVZJy.js";import{u as K}from"./useQuery-CY7cJG4M.js";import{d as _}from"./debounce-DdBoVYyJ.js";import{I as k}from"./hoist-non-react-statics.cjs-CmBnlRmG.js";import{b as H}from"./UserService-ssi5Dbga.js";import{B as L}from"./Button-B_bo9BV3.js";import"./Card-CMjPz5hL.js";import"./toString-DKANHZ97.js";import"./Views-tZVvsZbt.js";import"./index-VZ3FPubS.js";import"./_getPrototype-BGPo7mUk.js";const h={super_admin:{label:"Super Admin",dotClass:"bg-purple-500",textClass:"text-purple-500"},admin:{label:"Admin",dotClass:"bg-blue-500",textClass:"text-blue-500"},user:{label:"User",dotClass:"bg-gray-500",textClass:"text-gray-500"}},O=()=>{var p,g,x;const m=o.useRef(null),t=f(),[i,j]=o.useState(""),[n,u]=o.useState({page:1,limit:10}),[c,b]=o.useState(null);o.useEffect(()=>{const s=localStorage.getItem("user");if(s)try{b(JSON.parse(s))}catch(r){console.error("Error parsing user data:",r)}},[]);const{data:a,isLoading:C,error:d}=K({queryKey:["users",n,i],queryFn:()=>H({page:n.page,limit:n.limit,search:i})});o.useEffect(()=>{var s,r;console.log("Full API response:",a),console.log("Users data:",(s=a==null?void 0:a.data)==null?void 0:s.data),console.log("Pagination info:",(r=a==null?void 0:a.data)==null?void 0:r.pagination)},[a]);const N=o.useMemo(()=>_(s=>{j(s),u(r=>({...r,page:1}))},500),[]),y=o.useMemo(()=>[{header:"Username",accessorKey:"username",cell:s=>e.jsxs("div",{className:"flex items-center",children:[e.jsx(T,{icon:e.jsx(B,{}),alt:s.row.original.username}),e.jsx("span",{className:"ml-2 font-semibold",children:s.row.original.username})]})},{header:"Role",accessorKey:"role",cell:s=>{const r=s.row.original.role,l=h[r]||h.user;return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(D,{className:l.dotClass}),e.jsx("span",{className:`font-semibold ${l.textClass}`,children:l.label})]})}},{header:"Created At",accessorKey:"createdAt",cell:s=>e.jsx("span",{children:new Date(s.row.original.createdAt).toLocaleDateString()})},{header:"Actions",id:"action",cell:s=>{const{textTheme:r}=F(),l=s.row.original,S=l.role==="super_admin",w=(c==null?void 0:c.role)==="super_admin";return e.jsxs("div",{className:"flex justify-end text-lg",children:[e.jsx("span",{className:`cursor-pointer p-2 hover:${r}`,onClick:()=>t(`/users/view/${l.id}`),children:e.jsx(P,{})}),(!S||w)&&e.jsx("span",{className:`cursor-pointer p-2 hover:${r}`,onClick:()=>t(`/users/edit/${l.id}`),children:e.jsx(R,{})})]})}}],[t,c]);if(d)return e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsxs("span",{className:"text-red-500",children:["Error: ",d.message]})});const v=((p=a==null?void 0:a.data)==null?void 0:p.data)||[],A=((x=(g=a==null?void 0:a.data)==null?void 0:g.pagination)==null?void 0:x.total)||0;return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mb-4",children:e.jsx(k,{placeholder:"Search users...",onChange:s=>N(s.target.value),className:"max-w-md"})}),e.jsx(I,{ref:m,columns:y,data:v,loading:C,pagingData:{total:A,pageIndex:n.page,pageSize:n.limit},onPaginationChange:s=>u(r=>({...r,page:s})),onSelectChange:s=>u({page:1,limit:s})})]})},q=()=>{const m=f(),{user:t}=U(i=>i.auth);return(t==null?void 0:t.role)==="super_admin"||(t==null||t.role),e.jsx(L,{size:"sm",variant:"solid",icon:e.jsx($,{}),onClick:()=>m("/users/create"),children:"Add User"})},ie=()=>e.jsxs(E,{className:"h-full",bodyClass:"h-full",children:[e.jsxs("div",{className:"lg:flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"mb-4 lg:mb-0",children:"Users"}),e.jsx(q,{})]}),e.jsx(O,{})]});export{ie as default};
